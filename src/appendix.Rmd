---
title: "Supplementary material: The increasing cost of happiness"
author: "R.W. Morris^1,2^, N. Kettlewell^2,3,4^  & N.Glozier^1,5^"
bibliography: ../src/references.bib
csl: ../src/elsevier-harvard.csl
output:  
  html_document:
    reference_docx: ../src/academic_style.docx
always_allow_html: yes
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(tidyverse)
library(flextable)
library(bayesplot)

knitr::opts_chunk$set(eval = TRUE,
                      echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      fig.path = "../figures/")
```
\  
\  

1. Central Clinical School, Faculty of Medicine and Health, University of Sydney, NSW, Australia
2. ARC Centre of Excellence for Children and Families over the Life Course, University of Queensland, QLD, Australia
3. School of Economics, University of Technology, NSW, Australia
4. Institute of Labor Economics (IZA), Bonn, Germany
5. Brain and Mind Centre, University of Sydney, NSW, Australia 

\  

**Corresponding author:**  
Professor Nick Glozier  
Faculty of Medicine and Health,   
University of Sydney,  
NSW 2050,  
Australia  
email: nick.glozier@sydney.edu.au  

\  

Draft: `r format(Sys.time(), '%d %B, %Y')`  
Supplementary tables:      1  
Supplementary figures:     2  
  
**keywords:** Subjective wellbeing, household wealth, HILDA  

\  

***


## Supplementary Material

```{r read_write_covs}
happywealth_covs <- read_rds("../results/happywealth_covs.rds")
```

```{r funtimes}
source("../src/happyfun.r")
```

We tested the relationship between wealth and each wellbeing variable (happiness and satisfaction) using cubic **B-spline models**. A cubic B-spline was the most complex model (more degrees of freedom), and chosen because it has been recently used to describe the maximum point at which wellbeing no longer increases with wealth [i.e., "satiety", @jebb2018happiness]. Following Jebb et al [-@jebb2018happiness], we restricted the cubic B-spline model to *n* = 4, 5 and 6 knots and display wealth on a log scale.  

<br>


##### Figure S1. Cubic spline of household wealth on satisfaction and happiness
```{r losat_gh9_hwnwip}
library(patchwork)

p1 <- happywealth_covs %>%
  filter(adj_hifdip > 0) %>%
  rename(Satisfaction = losat, `Household wealth` = adj_hifdip) %>% 
  plot_inflection_cubic(Satisfaction, `Household wealth`) +
  scale_x_continuous(trans = "log", 
                     breaks = c(5, 10, 20, 40, 80, 160),
                     limits = c(2.5, 170))

p2 <- happywealth_covs %>%
  filter(adj_hifdip > 0) %>%
  rename(Happiness = gh9, `Household wealth` = adj_hifdip) %>% 
  plot_inflection_cubic(Happiness, `Household wealth`) +
  scale_x_continuous(trans = "log", 
                     breaks = c(5, 10, 20, 40, 80, 160),
                     limits = c(2.5, 170))
```
```{r cubic_plot, fig.height=9, fig.width=11}
p1 / p2
```

<br>

The cubic B-spline models failed to reveal a complete satiety point (horizontal inflection) in satisfaction before the highest decile in any year. Also note that despite using a log scale, we do not observe a clear, regular logarithmic function with either wellbeing measure. Other researchers have argued that wealth represents a quantitative dimension subject to Weber's Law of perception [@kahneman2010high]. Under this view, similar proportional changes in income or wealth produce similar evaluations of satisfaction or happiness, rather than the absolute change. That is, a \$100 increase in wealth will produce a greater impact on someone earning a minimum wage than someone earning many orders of magnitude of that amount. However while it is true that wealth clearly represents a quantitative dimension, the effects of wealth observed here represent cross-sectional differences in the population rather than changes experienced by an individual over time. It is not clear the extent to which Weber's Law applies to cross-sectional or between-subject differences in quantitative dimensions such as wealth.     

<br>

#### Change point model parameter estimates  

There were _df_ = 59,876 total observations. 4000 samples (post-warmup) were drawn using sampling(NUTS). For each parameter, Bulk_ESS and Tail_ESS are effective sample size measures, and Rhat is the potential scale reduction factor on split chains (at convergence, Rhat = 1).  

The Bayes R^2^ = 0.03964581 Â±0.001497172 (0.03672371-0.04262236)  

<br>

_Coefficient definitions_:  

_b0_ is the intercept denoting the expected value of wellbeing (y) at the changepoint  
_b1_ is the linear slope before the changepoint  
_b2_ is the linear slope after the changepoint  
_b3_ is the coefficient of education (graduate)  
_b4_ is the coefficient of sex (male)  
_b5_ is the coefficient of age  
_b6_ is the coefficient of age^2^  
_alpha_ is the expected value of wealth (x) at the changepoint  

<br>

```{r fit_summary, ft.align="left"}
hifdip_gh9_fixed_fit <- read_rds("../results/hifdip_gh9_fixed_full_covs.RDS")

fit_summary <- summary(hifdip_gh9_fixed_fit)

sigma <- fit_summary$spec_pars %>% 
  data.frame() %>%
  rownames_to_column("Coef") %>%
  mutate(Parameter = "Family Specific")

param_key = c(Intercept = "2002 (Intercept)",
              year2006 = "2006",
              year2010 = "2010",
              year2014 = "2014",
              year2018 = "2018")

fit_summary$fixed %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  separate(col = `Parameter`, into = c("Coef", "Parameter")) %>%
  mutate(Parameter = recode(Parameter, !!!param_key)) %>%
  bind_rows(sigma) %>%
  flextable() %>%
  merge_v(j = 1) %>%
  valign(j = 1, valign = "top") %>%
  bg(i = ~Coef %in% c("b0", "b2", "b4", "b6"), bg = "grey90", part = "body") %>%
  bg(i = ~Coef %in% c("sigma"), bg = "#b3cde0", part = "body") %>%
  colformat_num(j = 3:6, digits= 3) %>%
  colformat_num(j = 7, digits= 1) %>%
  set_caption("Table S1. Population-level parameter estimates") %>%
  autofit()
```


<br><br>

##### Figure S2. Posterior predictive distribution of marginal effect of wealth by year (95% CI)  

```{r figure_s2, fig.height = 3}
library(brms)

marginals <- conditional_effects(
  hifdip_gh9_fixed_fit,
  effects = c("dollars:year"), # year, dollars, 
  method = "fitted"
  ) 

marginals$`dollars:year`$year <- factor(marginals$`dollars:year`$year, 
                                        levels = c("2002", "2006", "2010", "2014", "2018"))

plot(marginals, plot=F)[[1]] +
  xlim(c(0, 30)) +
  ylim(c(-0.5, 1)) +
  facet_wrap(~year, nrow=1) +
  theme_test() +
  theme(legend.position = "none") +
  labs(x = "", y = "")
```

<br><br>

## References

